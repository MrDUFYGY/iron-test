---
import Layout from '../layouts/Layout.astro';
import "../styles/global.css";

---

<Layout>

    
<div class="mx-auto p-4 space-y-6">

    <!-- Buscador (espacio reservado o funcional si lo necesitas luego) -->
<!-- Buscador de movimientos -->
<div class="bg-white p-4 rounded-md shadow flex flex-wrap gap-4 items-end">
    <!-- Fecha -->
    <div class="flex flex-col">
      <label for="fecha" class="text-sm text-gray-600">Fecha</label>
      <input type="date" id="fecha" name="fecha"
             class="border border-gray-300 rounded-md px-3 py-1.5 text-sm w-44 focus:ring focus:ring-blue-200">
    </div>
  
    <!-- Tipo de transacción -->
    <div class="flex flex-col">
      <label for="tipoTransaccion" class="text-sm text-gray-600">Tipo</label>
      <select id="tipoTransaccion" name="tipoTransaccion"
              class="border border-gray-300 rounded-md px-3 py-1.5 text-sm w-40 bg-white focus:ring focus:ring-blue-200">
        <option value="">Todos</option>
        <option value="Pago">Pago</option>
        <option value="Cobro">Cobro</option>
      </select>
    </div>
  
    <!-- Tipo de pago o concepto -->
    <div class="flex flex-col">
      <label for="tipoPago" class="text-sm text-gray-600">Tipo de pago</label>
      <input type="text" id="tipoPago" name="tipoPago" placeholder="Ej. FAJILLAS"
             class="border border-gray-300 rounded-md px-3 py-1.5 text-sm w-52 focus:ring focus:ring-blue-200">
    </div>
  
    <!-- TPV -->
    <div class="flex flex-col">
      <label for="tpv" class="text-sm text-gray-600">TPV</label>
      <input type="text" id="tpv" name="tpv" placeholder="Ej. TPV 002"
             class="border border-gray-300 rounded-md px-3 py-1.5 text-sm w-40 focus:ring focus:ring-blue-200">
    </div>
  
    <!-- Botón de búsqueda -->
    <div>
      <button onclick="filtrarMovimientos()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm">
        Buscar
      </button>
    </div>
  </div>
  
  
    <!-- Encabezado -->
    <div class="flex flex-col space-y-1">
      <h1 class="text-xl font-semibold text-gray-800">
        Movimientos de caja <span class="text-gray-500">(06/03/2025 - P1-C3)</span>
      </h1>
      <p class="text-sm text-gray-500">3 Registros. Mostrando todos los registros.</p>
    </div>
  
    <!-- Tabla -->
    <div class="overflow-x-auto border border-gray-300 rounded-lg shadow-sm">
      <table class="min-w-full text-sm text-left text-gray-800">
        <thead class="bg-gray-100 text-gray-700 uppercase text-xs">
          <tr>
            <th class="px-4 py-2 font-medium">Liquidación</th>
            <th class="px-4 py-2 font-medium">Tipo</th>
            <th class="px-4 py-2 font-medium">Tipo de pago</th>
            <th class="px-4 py-2 font-medium">Empleado</th>
            <th class="px-4 py-2 font-medium">TPV</th>
            <th class="px-4 py-2 font-medium text-right">Importe</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          <tr>
            <td class="px-4 py-2">06/03/2025-P1-C3</td>
            <td class="px-4 py-2">Pago</td>
            <td class="px-4 py-2">03-FAJILLAS BILLETES</td>
            <td class="px-4 py-2">LUIS ALVARO VILLEGAS CAMPUZANO</td>
            <td class="px-4 py-2">TPV 002</td>
            <td class="px-4 py-2 text-right text-red-600">-261,240.00$</td>
          </tr>
          <tr>
            <td class="px-4 py-2">06/03/2025-P1-C3</td>
            <td class="px-4 py-2">Pago</td>
            <td class="px-4 py-2">40-DEPOSITO COMETRA</td>
            <td class="px-4 py-2">LUIS ALVARO VILLEGAS CAMPUZANO</td>
            <td class="px-4 py-2">TPV 002</td>
            <td class="px-4 py-2 text-right text-red-600">-261,240.00$</td>
          </tr>
          <tr>
            <td class="px-4 py-2">06/03/2025-P1-C3</td>
            <td class="px-4 py-2">Cobro</td>
            <td class="px-4 py-2">41-RETIRADA DE EFECTIVO</td>
            <td class="px-4 py-2">LUIS ALVARO VILLEGAS CAMPUZANO</td>
            <td class="px-4 py-2">TPV 002</td>
            <td class="px-4 py-2 text-right text-green-600">261,240.00$</td>
          </tr>
        </tbody>
        <tfoot class="bg-gray-50">
          <tr>
            <td colspan="5" class="px-4 py-2 font-semibold text-right">Total</td>
            <td class="px-4 py-2 text-right font-bold text-red-600">-261,240.00$</td>
          </tr>
        </tfoot>
      </table>
    </div>

<!-- Sección de gastos -->
<div class="mt-6">
  <div class="flex items-center space-x-2">
    <input type="checkbox" id="check-gastos" class="w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
    <label for="check-gastos" class="text-sm font-medium text-gray-700">Gastos</label>
  </div>

  <!-- Input de archivo para gastos (oculto por defecto) -->
  <div id="seccion-gastos" class="mt-4 hidden">
    <div class="border border-dashed border-gray-300 rounded-md p-4 bg-gray-50">
      <div class="flex justify-between items-center mb-2">
        <label class="block text-sm font-medium text-gray-700">Subir comprobante de gastos</label>
        <div class="flex items-center">
          <span id="estado-gastos" class="text-sm text-gray-500">Pendiente</span>
          <div id="check-gastos-icon" class="ml-2 hidden">
            <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
            </svg>
          </div>
        </div>
      </div>
      <input type="file" id="input-gastos" accept=".pdf"
             class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
      <p class="text-xs text-gray-400 italic mt-1">Archivo PDF opcional</p>
    </div>
  </div>
</div>

<script type="module">
  // Obtener elementos del DOM
  const checkGastos = document.getElementById('check-gastos');
  const seccionGastos = document.getElementById('seccion-gastos');
  
  // Agregar evento de cambio al checkbox
  checkGastos.addEventListener('change', (e) => {
    if (e.target.checked) {
      seccionGastos.classList.remove('hidden');
    } else {
      seccionGastos.classList.add('hidden');
    }
  });
</script>

<!-- Sección: Inputs de archivos + Nota -->
<div class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-6">

    <!-- Columna Izquierda: Dos inputs de archivo -->
    <div class="space-y-4">
  
      <!-- Subir archivo 1 -->
      <div class="border border-dashed border-gray-300 rounded-md p-4 bg-gray-50">
        <div class="flex justify-between items-center mb-2">
          <label class="block text-sm font-medium text-gray-700">Subir talón de banco</label>
          <div class="flex items-center">
            <span id="estado-archivo1" class="text-sm text-gray-500">Pendiente</span>
            <div id="check-archivo1" class="ml-2 hidden">
              <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
          </div>
        </div>
        <input type="file" id="input-archivo1" accept=".pdf"
               class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
        <p class="text-xs text-gray-400 italic mt-1">Archivo PDF requerido</p>
      </div>
  
      <!-- Subir archivo 2 -->
      <div class="border border-dashed border-gray-300 rounded-md p-4 bg-gray-50">
        <div class="flex justify-between items-center mb-2">
          <label class="block text-sm font-medium text-gray-700">Subir evidencia de firma</label>
          <div class="flex items-center">
            <span id="estado-archivo2" class="text-sm text-gray-500">Pendiente</span>
            <div id="check-archivo2" class="ml-2 hidden">
              <svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </div>
          </div>
        </div>
        <input type="file" id="input-archivo2" accept=".pdf"
               class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
        <p class="text-xs text-gray-400 italic mt-1">Archivo PDF requerido</p>
      </div>
  
    </div>
  
    <!-- Columna Derecha: Nota informativa -->
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md shadow-sm h-full">
      <h3 class="text-yellow-800 font-semibold mb-2">Nota:</h3>
      <ol class="list-decimal pl-5 space-y-1 text-sm text-gray-700">
        <li>Fecha</li>
        <li>Número de folio</li>
        <li>Monto</li>
        <li>Firma del gerente y de quien recogió el efectivo</li>
        <li>Talón de banco con información completa</li>
      </ol>
    </div>
  </div>
  






  </div>


  <!-- Botón para abrir el modal -->
  <button onclick="document.getElementById('modal-pdf').showModal()"
  class="mt-8 px-4 py-2 bg-blue-600 text-white rounded-md shadow hover:bg-blue-700 transition">
  Ver comprobante PDF
  </button>
  
  <!-- Modal con <dialog> -->
  <dialog id="modal-pdf" class="rounded-lg p-0 w-full max-w-[80%]">
  <div class="p-6 bg-white rounded-lg shadow-lg relative">
  
  <!-- Encabezado -->
  <h2 class="text-lg font-semibold text-gray-800 mb-4">Vista previa del comprobante</h2>
  
  <!-- Simulación PDF (puede ser imagen o iframe local) -->
  <div class="mb-4 border rounded overflow-hidden h-80">
  <iframe src="/assets/simulacion.pdf" class="w-full h-full" title="Vista previa PDF"></iframe>
  </div>
  
  <!-- Confirmación -->
  <p class="text-sm text-gray-700 mb-4">¿Todos los puntos del comprobante son correctos?</p>
  
  <!-- Botones -->
  <div class="flex justify-end space-x-2">
  <button onclick="document.getElementById('modal-pdf').close()"
        class="px-4 py-2 text-sm text-gray-600 bg-gray-100 rounded hover:bg-gray-200">
  Cancelar
  </button>
  <button onclick="document.getElementById('modal-pdf').close()"
        class="px-4 py-2 text-sm text-white bg-green-600 rounded hover:bg-green-700">
  Confirmar
  </button>
  </div>
  
  </div>
  </dialog>

<script type="module">
  // Manejo del primer archivo (talón de banco)
  document.getElementById('input-archivo1').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      document.getElementById('estado-archivo1').textContent = 'Cargado';
      document.getElementById('estado-archivo1').className = 'text-sm text-green-500';
      document.getElementById('check-archivo1').classList.remove('hidden');
    }
  });

  // Manejo del segundo archivo (evidencia de firma)
  document.getElementById('input-archivo2').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      document.getElementById('estado-archivo2').textContent = 'Pendiente de verificación';
      document.getElementById('estado-archivo2').className = 'text-sm text-red-500';
      document.getElementById('check-archivo2').classList.remove('hidden');
    }
  });
</script>

</Layout>
